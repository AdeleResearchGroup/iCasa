
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-05-18
 Rendered using Reflow Maven Skin 1.1.0 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>iCasa - How to build an iCasa Command</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/cerulean/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/bootswatch.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/github.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->


		
<link rel="stylesheet" type="text/css" href="./css/site.css"/>
<link rel="stylesheet" type="text/css" href="./css/font-awesome.css"/>
<script type="text/javascript">var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-35847694-2']);
                _gaq.push(['_trackPageview']);

                (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();</script>
<script type="text/javascript">$(document).ready(function () {
                $("pre code").parent().addClass("prettyprint");
                prettyPrint();
                });</script>
<link rel="shortcut icon" href="favicon.png"/>
	</head>

	<body class="page-building-command project-icasareactor" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top navbar-inverse">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html"><span class="color-highlight">iCasa</span></a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li ><a href="https://github.com/AdeleResearchGroup/iCasa" title="GitHub project" class="externalLink">GitHub project</a></li>
							<li ><a href="download.html" title="Download">Download</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">iCasa <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="index.html" title="Home">Home</a></li>
									<li ><a href="license.html" title="License">License</a></li>
									<li ><a href="overview.html" title="Overview">Overview</a></li>
									<li ><a href="architecture.html" title="Architecture">Architecture</a></li>
									<li ><a href="download.html" title="Download">Download</a></li>
									<li ><a href="install.html" title="Install">Install</a></li>
									<li ><a href="requires-device.html" title="Device Injection in iCasa">Device Injection in iCasa</a></li>
									<li ><a href="trackers.html" title="iCasa Trackers">iCasa Trackers</a></li>
									<li ><a href="technical-services.html" title="Technical Services">Technical Services</a></li>
									<li ><a href="faq.html" title="FAQ">FAQ</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="guide.html" title="Simulator GUI Guide">Simulator GUI Guide</a></li>
									<li class="dropdown-submenu ">
										<a href="building-command.html#" title="First App">First App</a>
										<ul class="dropdown-menu">
											<li ><a href="tutoIDE.html" title="With iCasa IDE">With iCasa IDE</a></li>
										</ul>
									</li>
									<li ><a href="script.html" title="Script Language">Script Language</a></li>
									<li ><a href="rest-api.html" title="REST API">REST API</a></li>
									<li ><a href="gogo-commands.html" title="Gogo commands">Gogo commands</a></li>
									<li ><a href="building-device.html" title="Device Building Tutorial">Device Building Tutorial</a></li>
									<li ><a href="apidocs/index.html" title="Javadoc">Javadoc</a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Advanced tutorials <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="active"><a href="" title="Building iCasa Commands">Building iCasa Commands</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Simulated Devices <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="lights.html" title="Lights">Lights</a></li>
									<li ><a href="heater.html" title="Heater/Cooler">Heater/Cooler</a></li>
									<li ><a href="detectors.html" title="Detectors">Detectors</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->

	<header>
		<div>
			<ul class="breadcrumb">
				<li class="projectVersion version-date">Version: 1.2.6-SNAPSHOT</li>
				<li class="divider">|</li>
				<li class="publishDate version-date">Last Published: 2014-05-18</li>
			</ul>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="page-header">
 <h1 id="how_to_build_an_icasa_command">How to build an iCasa Command</h1>
</div> 
<p><a name="Requirements"></a></p> 
<h2 id="1_tutorial_requirements">1. Tutorial Requirements</h2> 
<ul> 
 <li>OSGi &amp; iPOJO : iCasa is built on top of <a href="http://www.osgi.org">OSGi</a> platform and <a href="http://felix.apache.org/site/apache-felix-ipojo.html">iPOJO</a> component model. This tutorial is made using <a href="http://felix.apache.org/site/how-to-use-ipojo-annotations.html">iPOJO annotations</a>.</li> 
 <li>Maven (Optional) : <a href="http://maven.apache.org/">Maven</a> tool can be used to build new iCasa commands.</li> 
 <li>JSON: The <a href="http://www.json.org/">JSON</a> format is used to passed parameters to iCasa commands</li> 
</ul> 
<p><a name="Model"></a></p> 
<h2 id="2_icasa_command_model">2. iCasa Command Model</h2> 
<p>iCasa platform provides a command architecture allowing extension by third party developers. This architecture is based on the <a href="http://www.osgi.org/wiki/uploads/Links/whiteboard.pdf">OSGi whiteboard pattern</a>. In this tutorial we will show how to add new commands to the iCasa platform.</p> 
<p>iCasa Commands could be used two different ways:</p> 
<ul> 
 <li>Using the gogo shell. Interacting with the shell it is possible to call <a href="./gogo-commands.html">iCasa commands</a>.</li> 
 <li>Using iCasa scripts. It is possible to use the commands from an <a href="./script.html">iCasa script file</a> .</li> 
</ul> 
<p>This benefits the platform in two main ways:</p> 
<ul> 
 <li>commands allow to introspect the information of the current simulation (usually in the shell mode).</li> 
 <li>commands allow to modify the state of elements in current simulation.</li> 
</ul> 
<h2 id="3_create_command_with_annotations">3. Create Command with annotations</h2> 
<p>The easiest way to create iCasa command is to use the annotation and the specific handler provides by iCasa.</p> 
<h3 id="31_the_command_provider_handler">3.1. The Command Provider handler</h3> 
<p>The OSGi component mut have the CommandProvider annotation :</p> 
<pre><code>/**
*Use the handler command and declare the command as a command provider. The
*namespace is used to prevent name collision.
*/
@CommandProvider(namespace = &quot;yournamespace&quot;)
public class CommandComponent {

    .....

}
</code></pre> 
<h3 id="32_the_command_annotation">3.2. The Command annotation</h3> 
<p>Each methods that you want to be become a command must start with the @Command annotation.</p> 
<pre><code>/**
*Use the handler command and declare the command as a command provider. The
*namespace is used to prevent name collision.
*/
@CommandProvider(namespace = &quot;yournamespace&quot;)
public class CommandComponent {

     // Each command should start with a @Command annotation
      @Command
      public void yourCommand(String firstArgument){
       .....
      }

      // Each command should start with a @Command annotation
      @Command
      public void anOtherCommandWithNoArgument(){
        .....
      }

}
</code></pre> 
<h3 id="33_project_packaging">3.3. Project packaging</h3> 
<p>You can use <a href="http://felix.apache.org/site/apache-felix-ipojo.html">maven</a> tool to build a command project. Two iCasa maven artifacts are necessary to build your project, the first one context.api defines the interfaces used in the Command model, the command.handler provides the CommandProvider handler and the Command annotation.</p> 
<p>Artifacs :</p> 
<p><strong><em>Context API - iCasa Command interfaces</em></strong></p> 
<pre><code>&lt;groupId&gt;fr.liglab.adele.icasa&lt;/groupId&gt;
&lt;artifactId&gt;context.api&lt;/artifactId&gt;
&lt;version&gt;${project.version}&lt;/version&gt;
</code></pre> 
<p><strong><em>Command Handler - iCasa command handler and annotation</em></strong></p> 
<pre><code>&lt;groupId&gt;fr.liglab.adele.icasa&lt;/groupId&gt;
&lt;artifactId&gt;command.handler&lt;/artifactId&gt;
&lt;version&gt;${project.version}&lt;/version&gt;
</code></pre> 
<h2 id="4_create_command_with_icasa_command_interface">4. Create Command with iCasa Command Interface</h2> 
<h3 id="41_interfaces">4.1. Interfaces</h3> 
<p><a name="Interface"></a></p> 
<h4 id="411_icasa_command_interface">4.1.1. iCasa Command Interface</h4> 
<p>In order to add a new command to the iCasa platform, an OSGi service must be provided by the developer. This service has to implement the <em>fr.liglab.adele.icasaICasaCommand</em> interface, it is show below</p> 
<pre><code>/**
 * An ICommandService is a service that can be executed with a set of arguments. It can execute a block of code and then
 * returns the result object of executing this code.
 */
public interface ICasaCommand {
    /**
     * Execute a block of code and then returns the result from execution. This method should use {@code in} and
     * {@code out} stream to print result instead of the direct use of {@code System.in} and {@code System.out}
     * 
     * @param in : the input stream.
     * @param out : the output stream.
     * @param param a json object of parameters
     * 
     * @return the result from the execution
     * @throws Exception if anything goes wrong
     */
    Object execute(InputStream in, PrintStream out, JSONObject param) throws Exception;

    /**
     * To validate the given parameters.
     * 
     * @param param The parameters in JSON format
     * @return true if parameters are valid, false if not.
     * @throws Exception
     */
    boolean validate(JSONObject param, Signature signature) throws Exception;

    /**
     * Get the command description.
     * 
     * @return The description of the Script and command gogo.
     */
    String getDescription();

    /**
     * Get the name of the Script and command gogo.
     * 
     * @return The command name.
     */
    String getName();

    /**
     * Get signature by passing the number of arguments..
     * 
     * @return
     */
    Signature getSignature(int size);

}
</code></pre> 
<ul> 
 <li>The <em>getName()</em> method provides the command name (used in the shell as command).</li> 
 <li>The <em>getDescription()</em> method is called by the platform when users are looking for help of this command.</li> 
 <li>The <em>validate(JSONObject param, Signature signature)</em> method is invoked to validate parameters provided to the command. The validation is realized against a command signature.</li> 
 <li>The <em>getSignature(int size)</em> must return a command signature of the provided size.</li> 
 <li>The <em>execute(InputStream in, PrintStream out, JSONObject param)</em> will execute the set of instructions defining the iCasa command. This method is called by the platform after invocation of <em>validate</em> method and only if it returned true. The <em>in</em> and <em>out</em> parameter correspond to the standard input stream and output stream. Finally, the JSON object <em>param</em> contains the values of command parameters.</li> 
</ul> 
<p><a name="Signature"></a></p> 
<h4 id="412_command_signature">4.1.2. Command Signature</h4> 
<p>A command <strong>signature</strong> defines number and order of its parameters. When a command is used in the shell arguments are anonymous, iCasa platform determines the parameter correspondence only based in order. On the other hand, if the command is used in a script file, parameters are determined based on their names.</p> 
<p>Commands could have more than one signature, however signatures cannot contain the same number of parameters. The <em>fr.liglab.adele.icasa.Signature</em> class is presented in the next code snipped, to create a Signature only is necessary to provide an array of string corresponding to the name of parameters in the expected order (see constructor).</p> 
<pre><code>public class Signature {

    /**
     * The list of parameters for a given iCasaCommand signature.
     */
    private final String[] parameters;

    public Signature(String[] params) {
        this.parameters = params;
    }

    /**
     * Get the list of parameters of this signature.
     * 
     * @return the list of parameters.
     */
    public String[] getParameters() {
        return parameters;
    }

    ...
}
</code></pre> 
<p><a name="Implementation"></a></p> 
<h3 id="42_icasa_command_implementation">4.2. iCasa Command Implementation</h3> 
<p>In order to facilitate the creation of iCasa Commands, the abstract class <em>fr.liglab.adele.icasa.commands.impl.AbstractCommand</em> is provided by the iCasa platform. This class implements the <em>ICasaCommand</em> interface, it implements the <em>validate</em> and <em>getSignature</em> methods.</p> 
<p>A command implementation should extend the AbstractCommand and implements the <em>getName</em>, <em>getDescription</em> and <em>execute</em> methods. In addition, in the constructor of the implementation class must be defined the signatures of the command using the method <em>addSignature</em>. Finally, the implementation class must be annotated with the iPOJO annotations to expose itself as OSGi a service, this service will implement the right interface <em>ICasaCommand</em>. </p> 
<p>In order to illustrate how to create iCasa commands will show to different examples, the first one using no parameters, and other using parameters.</p> 
<p><a name="Implementation_No_Parameters"></a></p> 
<h4 id="421_command_without_parameters">4.2.1. Command without parameters</h4> 
<p>The following command displays the list of current devices in the iCasa platform. It does not take any parameter.</p> 
<pre><code>    @Component(name = &quot;ShowDevicesCommand&quot;)
    @Provides
    @Instantiate(name=&quot;show-devices-command&quot;)
    public class ShowDevicesCommand extends AbstractCommand {

        @Requires
        private ContextManager manager;

        /**
         * Get the name of the  Script and command gogo.
         *
         * @return The command name.
         */
        @Override
        public String getName() {
            return &quot;show-devices&quot;;
        }

        public ShowDevicesCommand(){
            addSignature(new Signature(new String[0])); // Adding an empty signature, without parameters
        }

        @Override
        public Object execute(InputStream in, PrintStream out, JSONObject param, Signature signature) throws Exception {
            out.println(&quot;Devices: &quot;);
            List&lt;LocatedDevice&gt; devices = manager.getDevices();
            for (LocatedDevice locatedDevice : devices) {
                out.println(&quot;Device &quot; + locatedDevice);
            }
            return null;
        }

        @Override
        public String getDescription(){
            return &quot;Shows the list of devices.\n\t&quot; + super.getDescription();
        }

    }
</code></pre> 
<p><a name="Implementation_Parameters"></a></p> 
<h4 id="422_command_with_parameters">4.2.2. Command with parameters</h4> 
<p>The following command displays the details of a particular device. </p> 
<pre><code>    @Component(name = &quot;ShowDeviceCommand&quot;)
    @Provides
    @Instantiate(name = &quot;show-device-command&quot;)
    public class ShowDeviceInfoCommand extends AbstractCommand {

        @Requires
        private ContextManager simulationManager;

        public ShowDeviceInfoCommand(){
            addSignature(new Signature(new String[]{&quot;deviceId&quot;})); // Adding a signatue with one parameter named deviceId
        }

        /**
         * Get the name of the  Script and command gogo.
         *
         * @return The command name.
         */
        @Override
        public String getName() {
            return &quot;show-device&quot;;
        }

        @Override
        public Object execute(InputStream in, PrintStream out, JSONObject param, Signature signature) throws Exception {
            String[] params = signature.getParameters();
            String deviceId = param.getString(params[0]);
            out.println(&quot;Properties: &quot;);
            LocatedDevice device = simulationManager.getDevice(deviceId);
            if (device==null) {
                throw new IllegalArgumentException(&quot;Device (&quot;+ deviceId +&quot;) does not exist&quot;);
            }
            Set&lt;String&gt; properties = device.getProperties();
            for (String property : properties) {
                out.println(&quot;Property: &quot; + property + &quot; - Value: &quot; +device.getPropertyValue(property));
            }
            return null;
        }

        @Override
        public String getDescription(){
            return &quot;Shows the information of a device.\n\t&quot; + super.getDescription();
        }

    }
</code></pre> 
<p><a name="Packaging"></a></p> 
<h3 id="43_project_packaging">4.3. Project Packaging</h3> 
<p>You can use <a href="http://felix.apache.org/site/apache-felix-ipojo.html">maven</a> tool to build a command project. Two iCasa maven artifacts are necessary to build your project, the first one context.api defines the interfaces used in the Command model, the context.impl provides the AbstractCommand class.</p> 
<p>Artifacs :</p> 
<p><strong><em>Context API - iCasa Command interfaces</em></strong></p> 
<pre><code>&lt;groupId&gt;fr.liglab.adele.icasa&lt;/groupId&gt;
&lt;artifactId&gt;context.api&lt;/artifactId&gt;
&lt;version&gt;1.1.2-SNAPSHOT&lt;/version&gt;
</code></pre> 
<p><strong><em>Context Impl - iCasa Command abstract class</em></strong></p> 
<pre><code>&lt;groupId&gt;fr.liglab.adele.icasa&lt;/groupId&gt;
&lt;artifactId&gt;context.impl&lt;/artifactId&gt;
&lt;version&gt;1.1.2-SNAPSHOT&lt;/version&gt;
</code></pre> 
<p>Repositories :</p> 
<pre><code>&lt;repositories&gt;
  &lt;repository&gt;
    &lt;snapshots&gt;
      &lt;enabled&gt;false&lt;/enabled&gt;
    &lt;/snapshots&gt;
    &lt;id&gt;adele-central-release&lt;/id&gt;
    &lt;name&gt;adele-repos&lt;/name&gt;
    &lt;url&gt;http://repository-icasa.forge.cloudbees.com/release&lt;/url&gt;
  &lt;/repository&gt;
  &lt;repository&gt;
    &lt;snapshots /&gt;
    &lt;id&gt;snapshots&lt;/id&gt;
    &lt;name&gt;adele-central-snapshot&lt;/name&gt;
    &lt;url&gt;http://repository-icasa.forge.cloudbees.com/snapshot&lt;/url&gt;
  &lt;/repository&gt;
&lt;/repositories&gt;
</code></pre> 
<p><a name="POM"></a></p> 
<h4 id="431_command_pom_model_file">4.3.1. Command Pom Model File</h4> 
<p>This is an extract of a maven project using the needed dependencies to build iCasa Commands. Also it shows dependencies for OSGi and iPOJO bundles, as well as their plugins configuration.</p> 
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;&gt;
   &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

   &lt;!-- Project coordinates --&gt;
   &lt;artifactId&gt;myCommand.project&lt;/artifactId&gt;
   &lt;packaging&gt;bundle&lt;/packaging&gt;
   &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;

   &lt;!-- Project repositories --&gt;
   &lt;repositories&gt;
     &lt;repository&gt;
       &lt;snapshots&gt;
        &lt;enabled&gt;false&lt;/enabled&gt;
       &lt;/snapshots&gt;
       &lt;id&gt;adele-central-release&lt;/id&gt;
       &lt;name&gt;adele-repos&lt;/name&gt;
       &lt;url&gt;http://repository-icasa.forge.cloudbees.com/release&lt;/url&gt;
     &lt;/repository&gt;
    &lt;repository&gt;
      &lt;snapshots /&gt;
      &lt;id&gt;snapshots&lt;/id&gt;
      &lt;name&gt;adele-central-snapshot&lt;/name&gt;
      &lt;url&gt;http://repository-icasa.forge.cloudbees.com/snapshot&lt;/url&gt;
     &lt;/repository&gt;
   &lt;/repositories&gt;

   &lt;!-- Project dependencies --&gt;
   &lt;dependencies&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.osgi&lt;/groupId&gt;
         &lt;artifactId&gt;org.osgi.core&lt;/artifactId&gt;
         &lt;version&gt;4.2.0&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
         &lt;artifactId&gt;org.apache.felix.ipojo&lt;/artifactId&gt;
         &lt;version&gt;1.10.1&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
         &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
         &lt;artifactId&gt;org.apache.felix.ipojo.annotations&lt;/artifactId&gt;
         &lt;version&gt;1.10.1&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;fr.liglab.adele.icasa&lt;/groupId&gt;
         &lt;artifactId&gt;context.api&lt;/artifactId&gt;
         &lt;version&gt;1.0.1-SNAPSHOT&lt;/version&gt;
      &lt;/dependency&gt;
      &lt;dependency&gt;
        &lt;groupId&gt;fr.liglab.adele.icasa&lt;/groupId&gt;
        &lt;artifactId&gt;context.impl&lt;/artifactId&gt;
        &lt;version&gt;1.0.1-SNAPSHOT&lt;/version&gt;
      &lt;/dependency&gt;
   &lt;/dependencies&gt;

   &lt;build&gt;
     &lt;plugins&gt;
       &lt;plugin&gt;
          &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
          &lt;artifactId&gt;maven-bundle-plugin&lt;/artifactId&gt;
          &lt;version&gt;2.3.7&lt;/version&gt;
          &lt;configuration&gt;
            &lt;instructions&gt;
               &lt;Private-Package&gt;fr.liglab.adele.icasa.zones.command.impl&lt;/Private-Package&gt;
            &lt;/instructions&gt;
          &lt;/configuration&gt;
        &lt;/plugin&gt;
     &lt;plugin&gt;
       &lt;groupId&gt;org.apache.felix&lt;/groupId&gt;
       &lt;artifactId&gt;maven-ipojo-plugin&lt;/artifactId&gt;
       &lt;version&gt;1.8.6&lt;/version&gt;
     &lt;/plugin&gt;
   &lt;/plugins&gt;
&lt;/build&gt;
&lt;/project&gt;
</code></pre> 
<p><a name="Usage"></a></p> 
<h2 id="5_icasa_command_usage">5. iCasa Command Usage</h2> 
<p>As said before, iCasa Commands has two usages, the first one to be called from the shell, and the other one to be used from an iCasa Script.</p> 
<p><a name="Osgi-Shell"></a></p> 
<h3 id="51_osgi_shell">5.1. OSGi Shell</h3> 
<p>To see the parameter order in the shell, we can call the icasa:help command, which will show the commands description, as well as the parameters list.</p> 
<pre><code>g!icasa:help

icasa:show-zones
    Shows the list of zones.
    Parameters: 
    ()
icasa:move-person
    Move a person to a new X,Y position.
    Parameters: 
    ( personId  newX  newY )
    ( personId  newX  newY  newZ )
g!
</code></pre> 
<p>So, for example, to move a person, we have two signatures with three and four parameters respectively:</p> 
<pre><code>g! move-person Jean 40 40
</code></pre> 
<p>and</p> 
<pre><code>g! move-person Jean 50 50 50
</code></pre> 
<p><a name="iCasa-Scripts"></a></p> 
<h3 id="52_icasa_scripts">5.2. iCasa Scripts</h3> 
<p>iCasa provides a mechanism to execute scripts. This is presented in the <a href="script.html">script</a> section. But also, the script language can be extended by using commands. So, new commands could be executed in a given script. The command name (the string returned in the getName() method) must be represented by an XML tag. And the parameters are represented by the attributes contained in those tags.</p> 
<p>For example, it is possible to move a person by putting in the script the following:</p> 
<pre><code>&lt;move-person personId=&quot;Jean&quot; newX=&quot;40&quot; newY=&quot;40&quot;/&gt;
</code></pre> 
<p>or</p> 
<pre><code>&lt;move-person personId=&quot;Jean&quot; newX=&quot;50&quot; newY=&quot;50&quot; newZ=&quot;50&quot;/&gt;
</code></pre>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#how_to_build_an_icasa_command" title="How to build an iCasa Command">How to build an iCasa Command <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#1_tutorial_requirements" title="1. Tutorial Requirements">1. Tutorial Requirements</a>
		<li><a href="#2_icasa_command_model" title="2. iCasa Command Model">2. iCasa Command Model</a>
		<li class="dropdown"><a href="#3_create_command_with_annotations" title="3. Create Command with annotations">3. Create Command with annotations <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#31_the_command_provider_handler" title="3.1. The Command Provider handler">3.1. The Command Provider handler</a>
		<li><a href="#32_the_command_annotation" title="3.2. The Command annotation">3.2. The Command annotation</a>
		<li><a href="#33_project_packaging" title="3.3. Project packaging">3.3. Project packaging</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#4_create_command_with_icasa_command_interface" title="4. Create Command with iCasa Command Interface">4. Create Command with iCasa Command Interface <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li class="dropdown"><a href="#41_interfaces" title="4.1. Interfaces">4.1. Interfaces <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#411_icasa_command_interface" title="4.1.1. iCasa Command Interface">4.1.1. iCasa Command Interface</a>
		<li><a href="#412_command_signature" title="4.1.2. Command Signature">4.1.2. Command Signature</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#42_icasa_command_implementation" title="4.2. iCasa Command Implementation">4.2. iCasa Command Implementation <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#421_command_without_parameters" title="4.2.1. Command without parameters">4.2.1. Command without parameters</a>
		<li><a href="#422_command_with_parameters" title="4.2.2. Command with parameters">4.2.2. Command with parameters</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#43_project_packaging" title="4.3. Project Packaging">4.3. Project Packaging <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#431_command_pom_model_file" title="4.3.1. Command Pom Model File">4.3.1. Command Pom Model File</a>
				<li class="divider"></li>
			</ul>
		</li>
			</ul>
		</li>
		<li class="dropdown"><a href="#5_icasa_command_usage" title="5. iCasa Command Usage">5. iCasa Command Usage <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#51_osgi_shell" title="5.1. OSGi Shell">5.1. OSGi Shell</a>
		<li><a href="#52_icasa_scripts" title="5.2. iCasa Scripts">5.2. iCasa Scripts</a>
				<li class="divider"></li>
			</ul>
		</li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">iCasa</li>
						<li >
							<a href="index.html" title="Home">Home</a>
						</li>
						<li >
							<a href="license.html" title="License">License</a>
						</li>
						<li >
							<a href="overview.html" title="Overview">Overview</a>
						</li>
						<li >
							<a href="architecture.html" title="Architecture">Architecture</a>
						</li>
						<li >
							<a href="download.html" title="Download">Download</a>
						</li>
						<li >
							<a href="install.html" title="Install">Install</a>
						</li>
						<li >
							<a href="requires-device.html" title="Device Injection in iCasa">Device Injection in iCasa</a>
						</li>
						<li >
							<a href="trackers.html" title="iCasa Trackers">iCasa Trackers</a>
						</li>
						<li >
							<a href="technical-services.html" title="Technical Services">Technical Services</a>
						</li>
						<li >
							<a href="faq.html" title="FAQ">FAQ</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">User Guide</li>
						<li >
							<a href="guide.html" title="Simulator GUI Guide">Simulator GUI Guide</a>
						</li>
						<li >
							<a href="building-command.html#" title="First App">First App <i class="icon-chevron-down"></i></a>
							<ul class="nav nav-list">
						<li >
							<a href="tutoIDE.html" title="With iCasa IDE">With iCasa IDE</a>
						</li>
							</ul>
						</li>
						<li >
							<a href="script.html" title="Script Language">Script Language</a>
						</li>
						<li >
							<a href="rest-api.html" title="REST API">REST API</a>
						</li>
						<li >
							<a href="gogo-commands.html" title="Gogo commands">Gogo commands</a>
						</li>
						<li >
							<a href="building-device.html" title="Device Building Tutorial">Device Building Tutorial</a>
						</li>
						<li >
							<a href="apidocs/index.html" title="Javadoc">Javadoc</a>
						</li>
					</ul>
				</div>
				<div class="span2 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Advanced tutorials</li>
						<li class="active">
							<a href="#" title="Building iCasa Commands">Building iCasa Commands</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Simulated Devices</li>
						<li >
							<a href="lights.html" title="Lights">Lights</a>
						</li>
						<li >
							<a href="heater.html" title="Heater/Cooler">Heater/Cooler</a>
						</li>
						<li >
							<a href="detectors.html" title="Detectors">Detectors</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2012-2014 <a href="http://www-adele.imag.fr/">ADELE Research Group</a>. All Rights Reserved.</p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	
	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
